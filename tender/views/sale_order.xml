<odoo>
    <record id="construction_sale_order_form" model="ir.ui.view">
        <field name="name">construction_sale_order_form</field>
        <field name="model">construction.sale.order</field>
        <field name="arch" type="xml">
            <form>
                <header>

                    <button string="Confirm" name="action_confirm" invisible="state!='draft'"
                            type="object"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,confirm"/>
                </header>
                <sheet>
                    <h2>
                        <field name="name" readonly="1"/>
                    </h2>
                    <group>
                        <group>

                            <field name="partner_id"
                                    required="1"  readonly="state=='confirm'"/>
                            <field name="project_id" required="1"  readonly="state=='confirm'"/>
                            <field name="estimation_version" readonly="1"/>


                        </group>
                        <group>
                            <field name="created_date"  readonly="state=='confirm'"/>
                            <!--                            <field name="discount_lines"  readonly="state=='confirm'"/>-->
                            <field name="version" readonly="1"/>
                            <field name="tag_ids" widget="many2many_tags"/>
                            <!--                            <field name="global_discount"/>-->
                        </group>
                    </group>
                    <button string="Round" name="action_round" type="object"/>
                    <notebook>
                        <page string="Lines">
                            <field name="order_lines"  readonly="state=='confirm'"
                                   widget="section_and_note_one2many">
                                <tree editable="bottom">
                                    <control>
                                        <create name="add_product_control" string="Add line"/>
                                        <create name="add_section_control" string="Add a section"
                                                context="{'default_display_type': 'line_section'}"/>
                                        <create name="add_note_control" string="Add a note"
                                                context="{'default_display_type': 'line_note'}"/>
                                    </control>
                                    <field name="display_type" invisible="1" optional="show"/>
                                    <field name="sequence" widget="handle" optional="show"/>
                                    <field name="type" invisible="1"/>
                                    <field name="name" required="display_type==False"
                                           widget="section_and_note_text"
                                           optional="show"/>

                                    <field name="item" optional="show"
                                           required="display_type==False"/>
                                    <field name="description" optional="show"
                                           required="display_type==False"/>
                                    <field name="uom_id" optional="show"
                                           required="display_type==False"/>
                                    <field name="qty" optional="show"
                                            required="1"  readonly="type=='main'"/>
                                    <field name="price" optional="show" readonly="1"/>
                                    <field name="price_unit" optional="show"
                                            required="1"  readonly="type=='main'"/>
                                    <field name="tax_ids" widget="many2many_tags"/>
                                    <field name="amount_tax"/>
                                    <field name="amount_after_tax"/>
                                    <!--                                    <field name="discount" optional="show" attrs="{'readonly':[('type','=','main')]}"/>-->

                                    <!--                                    <field name="parent_item" required="display_type==False"/>-->

                                    <field name="notes"/>

                                </tree>
                                <form>

                                    <group>
                                        <field name="display_type" invisible="1"/>
                                        <field name="name"/>

                                        <field name="item" required="display_type==False"/>
                                        <field name="type" invisible="1"/>
                                        <field name="description" required="display_type==False"/>
                                        <field name="uom_id" required="display_type==False"/>
                                        <field name="qty"  required="1"  readonly="type=='main'"/>

                                        <field name="price_unit"
                                                required="1"  readonly="type=='main'"/>
                                        <!--                                        <field name="discount"/>-->
                                        <field name="price"/>
                                        <field name="amount_after_tax"/>
                                        <!--                                    <field name="parent_item" required="1"/>-->

                                        <field name="notes"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                    </notebook>
                    <group class="oe_subtotal_footer oe_right">
                        <field name="amount_before_dis"/>
                        <!--                        <field name="total_discount"/>-->

                        <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                            <label for="amount_tax"/>
                        </div>
                        <field name="amount_tax" nolabel="1" class="oe_subtotal_footer_separator"
                               widget="monetary"/>
                        <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                            <label for="total"/>
                        </div>
                        <field name="total" nolabel="1" class="oe_subtotal_footer_separator"
                               widget="monetary"/>
                    </group>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>

        </field>
    </record>

    <record id="construction_sale_order_tree" model="ir.ui.view">
        <field name="name">construction_sale_order_tree</field>
        <field name="model">construction.sale.order</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name" optional="show"/>
                <field name="partner_id" optional="show"/>
                <field name="project_id" required="1" optional="show"/>
                <field name="created_date" optional="show"/>
                <field name="total_discount" optional="show"/>
                <field name="total" optional="show"/>
                <field name="state" optional="show"/>
                <field name="version" optional="show"/>
                <field name="estimation_version" optional="show"/>
            </tree>
        </field>
    </record>
    <record id="search_sale_cost" model="ir.ui.view">
        <field name="name">search_sale_cost</field>
        <field name="model">construction.sale.order</field>
        <field name="arch" type="xml">
            <search string="">
                <field name="name" string="name"/>
                <field name="tag_ids"/>
                <separator/>
                <filter string="Active" name="active" domain="[('active', '=', True)]"/>
                <filter string="Hold" name="inactive" domain="[('active', '=', False)]"/>
                <filter string="Version" name="version" context="{'group_by': 'version'}"/>
                <filter name="tag_ids" string="Tags" domain="[]" context="{'group_by': 'tag_id_custom'}"/>

            </search>
        </field>
    </record>


</odoo>